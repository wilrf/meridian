---
title: "Debugging"
phase: 3
order: 5
requires: []
prev: "3.4_apis"
next: "3.6_testing"
---

# Lesson 5: Debugging

> **Note:** This platform provides a simplified environment. While `print()` debugging works everywhere, tools like `pdb` or VS Code breakpoints require a local setup.

## The Problem

You wrote code. You ran it. It crashed. Or worse, it ran but gave the wrong answer. Now you're staring at the screen, frustrated. You need a systematic way to find out *what* went wrong and *where*.

---

## The Metaphor

Debugging is **detective work**.

- The **Bug** is the criminal.
- The **Traceback** (error message) is the crime scene report.
- **Print statements** are like interviewing witnesses ("What was the value of X at this moment?").
- The **Debugger** is like a slow-motion camera replays the crime frame-by-frame.

Novices guess. Experts investigate.

---

## The Technical Reality

### 1. Reading the Traceback

Python's error messages are actually helpful if you know how to read them. **Read from the bottom up.**

```text
Traceback (most recent call last):
  File "main.py", line 10, in <module>
    calculate_total(items)
  File "main.py", line 5, in calculate_total
    return sum(item['price'] for item in items)
  File "main.py", line 5, in <genexpr>
    return sum(item['price'] for item in items)
KeyError: 'price'
```

1.  **Bottom line**: `KeyError: 'price'`. This is *what* happened. A dictionary was missing the key 'price'.
2.  **Line above that**: `File "main.py", line 5`. This is *where* it happened.
3.  **Lines above that**: The path the code took to get there (the "Call Stack").

### 2. Print Debugging

The oldest tool in the book.

```python
def calculate_roi(profit, cost):
    print(f"DEBUG: profit={profit}, cost={cost}")  # The witness
    return (profit / cost) * 100
```

If you see `DEBUG: profit=100, cost=0`, you immediately know why you got a `ZeroDivisionError`.

### 3. The Python Debugger (pdb)

Python has a built-in interactive debugger. You can pause your code in the middle of execution.

Add this line where you want to stop:
```python
breakpoint()  # Python 3.7+
```

When code hits this line, it pauses. You get a `(Pdb)` prompt:
- `n` (next): Run next line.
- `s` (step): Step *into* a function call.
- `c` (continue): Run until next breakpoint.
- `p variable`: Print a variable's value.
- `l` (list): Show surrounding code.

---

## The Code

### Using `breakpoint()`

~~~python runnable
def complex_calculation(x, y):
    result = x * 2
    # breakpoint()  # Uncomment this in a real terminal to pause
    # In this web runner, we'll simulate it with print
    print(f"DEBUG: result before division={result}")
    
    final = result / y
    return final

# This will crash
# complex_calculation(10, 0)
~~~

### VS Code Debugger (The Pro Way)

If you are using VS Code (which you should be!):
1.  Click the **Run and Debug** icon (Play button with a bug) on the left sidebar.
2.  Click "Run and Debug".
3.  Click in the margin to the left of a line number to set a **red dot** (breakpoint).
4.  Run the code. It will pause at the red dot.
5.  Hover your mouse over variables to see their values.

This is much faster than typing `print()` everywhere.

---

## The Exercise

### Exercise 3.5: Be the Detective

Here is a broken function. It's supposed to find the average price, but it crashes or returns wrong answers.

Find the bugs (there are 3).

~~~python exercise id="3.5"
def get_average_price(prices):
    total = 0
    # Bug 1: Range logic might be wrong?
    for i in range(len(prices) + 1):
        total += prices[i]
    
    # Bug 2: What if the list is empty?
    average = total / len(prices)
    return average

# Test cases (Run these to see the crashes)
# print(get_average_price([10, 20, 30]))
# print(get_average_price([]))
~~~

---

## The Gotchas

### Gotcha 1: Debugging with `print` and forgetting to remove it
You don't want your production logs filled with `DEBUG: HERE!!!!`.
*Fix*: Use a proper logging library (we'll learn that later) or use the debugger.

### Gotcha 2: Misreading the Traceback
Sometimes the error is reported on line 10, but the mistake was on line 9 (e.g., missing parenthesis). If line 10 looks perfect, look at the line before it.

### Gotcha 3: "It works on my machine"
This usually means your environment is different. Did you activate your `venv`? Are you using the same data?

---

## Key Takeaways

1.  **Read Tracebacks from the bottom up**.
2.  **`print()`** is quick, but **Debuggers** (VS Code / pdb) are powerful.
3.  **`breakpoint()`** pauses execution so you can look around.
4.  Don't guessâ€”verify your assumptions about variable values.

---

## Next Lesson

You know how to fix bugs when you find them. But how do you prevent them from happening in the first place? **Testing**.
